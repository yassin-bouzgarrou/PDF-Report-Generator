<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<div class="container">
<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
<div class="logo-container">
  <div class="logo">
    <div class="logo-icon">
      <%= image_tag("00adee.png", alt: "Oktoboot Logo", class: "logo-img") %>
    </div>
 
  </div>

</div>



<div class="nav-section">
<div class="nav-section-title">Overview</div>
<ul class="nav-links">
<li><a class="active" href="#executive-summary"><i class="fas fa-chart-pie"></i> Executive Summary</a></li>
<li><a href="#methodology"><i class="fas fa-tasks"></i> Methodology</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">Intelligence</div>
<ul class="nav-links">
<li><a href="#domain-dns"><i class="fas fa-globe"></i> Domain &amp; DNS</a></li>
<li><a href="#network"><i class="fas fa-network-wired"></i> Network Infrastructure</a></li>
<li><a href="#subdomains"><i class="fas fa-sitemap"></i> Subdomain Enumeration</a></li>
<li><a href="#certificates"><i class="fas fa-certificate"></i> Certificate Enumeration</a></li>
<li><a href="#exposed-assets"><i class="fas fa-exclamation-triangle"></i> Exposed Assets</a></li>
<li><a href="#data-leaks"><i class="fas fa-user-secret"></i> Data Leaks</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">Findings</div>
<ul class="nav-links">
<li><a href="#employee-enum"><i class="fas fa-users"></i> Employee Enumeration</a></li>
<li><a href="#metadata-files"><i class="fas fa-file-alt"></i> Metadata &amp; Files</a></li>
<li><a href="#risk-assessment"><i class="fas fa-exclamation-circle"></i> Risk Assessment</a></li>
<li><a href="#recommendations"><i class="fas fa-clipboard-check"></i> Recommendations</a></li>
</ul>
</div>
</aside>
<!-- Header -->
<header class="header">
<button class="mobile-menu-toggle" id="mobile-menu-toggle">
<i class="fas fa-bars"></i>
</button>
<div class="header-title">
         Threat Intelligence Report - <%= @report[:domain] %>
            </div>
<div class="header-actions">
<%= link_to export_pdf_report_path(@report), class: 'header-button' do %>
  <i class="fas fa-download"></i> Export PDF
<% end %>

</div>
</header>
<!-- Main Content -->
<main class="main-content">
<div class="report-header">
<h1 class="report-title">
                    Threat Intelligence Report - <%= @report[:domain] %>
                    <span class="report-title-badge">Confidential</span>
</h1>
<div class="report-meta">
<div class="report-meta-item">
<i class="far fa-calendar-alt"></i>
<span>Created: <strong><%= @report[:created_at] %></strong></span>
</div>
<div class="report-meta-item">
<i class="fas fa-sync-alt"></i>
<span>Updated: <strong><%= @report[:created_at] %></strong></span>
</div>
<div class="report-meta-item">
<i class="fas fa-code-branch"></i>
<span>Version: <strong>1.0</strong></span>
</div>
<div class="report-meta-item">
<i class="fas fa-robot"></i>
<span>Generated By: <strong>Oktoboot System</strong></span>
</div>
</div>
</div>
<!-- Dashboard Cards -->
<div class="dashboard">
<div class="dashboard-card">
<div class="dashboard-card-header">
<div class="dashboard-card-title">Subdomains</div>
<div class="dashboard-card-icon icon-primary">
<i class="fas fa-sitemap"></i>
</div>
</div>
<div class="dashboard-card-content">
<div class="dashboard-card-value"><%= @report[:subdomains_count] %></div>
<div class="dashboard-card-label">Total subdomains discovered</div>
</div>
<div class="dashboard-card-footer">
<i class="fas fa-arrow-up trend-up"></i>
<span><%= @report[:new_subdomains] %> new since last scan</span>
</div>
</div>
<div class="dashboard-card">
<div class="dashboard-card-header">
<div class="dashboard-card-title">Exposed Assets</div>
<div class="dashboard-card-icon icon-danger">
<i class="fas fa-exclamation-triangle"></i>
</div>
</div>
<div class="dashboard-card-content">
<div class="dashboard-card-value"><%= @report[:exposed_assets_count] %></div>
<div class="dashboard-card-label">Assets with potential exposure</div>
</div>
<div class="dashboard-card-footer">
<i class="fas fa-arrow-down trend-down"></i>
<span>Critical attention required</span>
</div>
</div>
<div class="dashboard-card">
<div class="dashboard-card-header">
<div class="dashboard-card-title">Leaked Credentials</div>
<div class="dashboard-card-icon icon-warning">
<i class="fas fa-key"></i>
</div>
</div>
<div class="dashboard-card-content">
<div class="dashboard-card-value"><%= @report[:leaked_credentials_count] %></div>
<div class="dashboard-card-label">Credentials found in breaches</div>
</div>
<div class="dashboard-card-footer">
<i class="fas fa-exclamation-circle"></i>
<span>Immediate action recommended</span>
</div>
</div>
</div>


<!-- Executive Summary -->
<section class="section" id="executive-summary">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-chart-pie"></i>
</div>
<h2>Executive Summary</h2>
</div>
<div class="section-toggle open">
<i class="fas fa-chevron-up"></i>
</div>
</div>
<div class="section-content">
<p><strong>Overview:</strong> This is a sample overview…</p>
<p><strong>Scope:</strong> <%= @report[:domain] %></p>
<div class="chart-container mt-4">
<div class="chart-header">
<div class="chart-title">Threat Summary</div>
</div>
<div class="chart-placeholder">
    <canvas id="myChart"></canvas>

</div>
</div>
</div>
</section>
<!-- Methodology -->
<section id="methodology" class="section">
  <div class="section-header">
    <div class="section-header-left">
      <div class="section-header-icon">
        <i class="fas fa-tasks"></i>
      </div>
      <h2>Methodology</h2>
    </div>
    <div class="section-toggle">
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>

  <div class="section-content" style="display: none;">
    <% @report[:methodology].each do |section| %>
      <div class="subsection">
        <h3 class="subsection-title">
          <i class="<%= section[:icon] %>"></i> <%= section[:title] %>
        </h3>

        <% section[:steps].each do |step| %>
          <div class="methodology-item">
            <p><strong><%= step[:title] %></strong></p>
            <p>
              <% if step[:status] == "completed" %>
                <span class="status status-completed">
                  <i class="fas fa-check-circle"></i> Completed
                </span>
              <% elsif step[:status] == "in-progress" %>
                <span class="status status-in-progress">
                  <i class="fas fa-spinner fa-spin"></i> In Progress
                </span>
              <% else %>
                <span class="status status-pending">
                  <i class="fas fa-clock"></i> Pending
                </span>
              <% end %>
            </p>
            <p><%= step[:description] %></p>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</section>

<!-- Domain & DNS Intelligence -->
<section id="domain-dns" class="section">
  <div class="section-header">
    <div class="section-header-left">
      <div class="section-header-icon">
        <i class="fas fa-globe"></i>
      </div>
      <h2>Domain &amp; DNS Intelligence</h2>
    </div>
    <div class="section-toggle">
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>
  <div class="section-content" style="display: none;">
    <div class="subsection">
      <h3 class="subsection-title"><i class="fas fa-sitemap"></i> Domains</h3>
      <% if @report[:dns].present? && @report[:dns][0].present? %>
        <p>Total Domains Identified: <%= @report[:dns][0][:total_domains] %></p>
      <% else %>
        <p>No DNS data available.</p>
      <% end %>
    </div>
    <div class="subsection">
      <h3 class="subsection-title"><i class="fas fa-server"></i> DNS Records</h3>
      <h4 class="mb-2">NS Records</h4>
      <div class="table-container">
        <% if @report[:dns].present? && @report[:dns][0][:ns_records].present? %>
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>IP</th>
              </tr>
            </thead>
            <tbody>
              <% @report[:dns][0][:ns_records].each do |record| %>
                <tr>
                  <td><%= record[:name] %></td>
                  <td><%= record[:ip] %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        <% else %>
          <p>No NS records available.</p>
        <% end %>
      </div>
      <div class="note">
        <i class="fas fa-info-circle"></i> Note about NS records
      </div>
      <h4 class="mb-2 mt-4">MX Records</h4>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>IP</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>mail.<%= @report[:domain] %></td>
              <td>198.51.100.2</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="note">
        <i class="fas fa-info-circle"></i> Note about MX records
      </div>
    </div>
  </div>
</section>


<!-- Network Infrastructure -->
<section id="network" class="section">
  <div class="section-header">
    <div class="section-header-left">
      <div class="section-header-icon">
        <i class="fas fa-network-wired"></i>
      </div>
      <h2>Network Infrastructure</h2>
    </div>
    <div class="section-toggle">
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>
  <div class="section-content" style="display: none;">
    <div class="subsection">
      <h3 class="subsection-title"><i class="fas fa-project-diagram"></i> AS Number Overview</h3>
      <% if @report[:network][:total_asns].present? %>
        <p>Total ASNs Identified: <%= @report[:network][:total_asns] %></p>
      <% else %>
        <p>No ASN data available.</p>
      <% end %>
    </div>
    <div class="subsection">
      <h3 class="subsection-title"><i class="fas fa-share-alt"></i> Shared Hosting Exposure</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Domain</th>
              <th>Shared With</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><%= @report[:network][:shared_hosting][:domain] %></td>
              <td>
                <% @report[:network][:shared_hosting][:shared_with].each do |shared_domain| %>
                  <%= shared_domain %><br>
                <% end %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="note">
        <i class="fas fa-info-circle"></i> Some note about shared hosting
      </div>
    </div>
  
  </div>
</section>


<!-- Subdomain Enumeration -->
<section class="section" id="subdomains">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-sitemap"></i>
</div>
<h2>Subdomain Enumeration</h2>
</div>
<div class="section-toggle">
<i class="fas fa-chevron-down"></i>
</div>
</div>
<div class="section-content" style="display: none;">
<p>This section highlights a sample of the subdomains identified during the reconnaissance process. The full list — along with associated technologies, open ports, and vulnerabilities — is available in the Oktoboot dashboard for deeper investigation and remediation.</p>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-list"></i> Subdomains</h3>
<p>Total Unique Subdomains Found: 4</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Root Domain</th>
<th>Subdomain</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="3"><%= @report[:domain] %></td>
<td>a.<%= @report[:domain] %></td>
</tr>
<tr>
<td>b.<%= @report[:domain] %></td>
</tr>
<tr>
<td>dev.<%= @report[:domain] %></td>
</tr>
<tr>
<td>test.com</td>
<td>c.test.com</td>
</tr>
</tbody>
</table>
</div>
<div class="note">
<i class="fas fa-info-circle"></i> Only a subset shown
                        </div>
</div>

</div>
</section>
<!-- Certificate HTTPS Enumeration -->
<section class="section" id="certificates">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-certificate"></i>
</div>
<h2>Certificate HTTPS Enumeration</h2>
</div>
<div class="section-toggle">
<i class="fas fa-chevron-down"></i>
</div>
</div>
<div class="section-content" style="display: none;">
<p>This section summarizes digital certificates discovered during reconnaissance. Certificates may reveal subdomains or exposure timelines. Review carefully — and check Oktoboot Dashboard for full details.</p>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-shield-alt"></i> Certificates</h3>
<div class="table-container">
<table>
<thead>
<tr>
<th>Common Name</th>
<th>Valid From</th>
<th>Valid To</th>
</tr>
</thead>
<tbody>
<tr>
<td><%= @report[:domain] %></td>
<td>2024‑01‑01</td>
<td>2025‑01‑01</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</section>
<!-- Exposed Assets Overview -->

<!-- Data Leaks & Credential Exposure -->
<section class="section" id="data-leaks">
  <div class="section-header">
    <div class="section-header-left">
      <div class="section-header-icon">
        <i class="fas fa-user-secret"></i>
      </div>
      <h2>Data Leaks &amp; Credential Exposure</h2>
    </div>
    <div class="section-toggle">
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>
  <div class="section-content" style="display: none;">
    <p>These exposed credentials were found across malware logs, public breaches, and combo lists. They may be linked to user accounts or internal access points. Please investigate and rotate impacted credentials immediately. Full dump available in the Oktoboot dashboard.</p>

    <% if @report[:leaks][:logstealer].any? %>
      <div class="subsection">
        <h3 class="subsection-title"><i class="fas fa-bug"></i> Logstealer Leaks</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>URL</th>
                <th>Email</th>
                <th>Password</th>
                <th>Year</th>
              </tr>
            </thead>
            <tbody>
              <% @report[:leaks][:logstealer].each do |leak| %>
                <tr>
                  <td><%= leak[:url] %></td>
                  <td><%= leak[:email] %></td>
                  <td><%= leak[:password] %></td>
                  <td><%= leak[:year] %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
        <div class="note">
          <i class="fas fa-info-circle"></i> Logstealer note
        </div>
      </div>
    <% end %>

    <% if @report[:leaks][:public].any? %>
      <div class="subsection">
        <h3 class="subsection-title"><i class="fas fa-unlock"></i> Public Breach Leaks</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Leak Source</th>
                <th>Email</th>
                <th>Password</th>
                <th>Year</th>
              </tr>
            </thead>
            <tbody>
              <% @report[:leaks][:public].each do |leak| %>
                <tr>
                  <td><%= leak[:leak_source] %></td>
                  <td><%= leak[:email] %></td>
                  <td><%= leak[:password] %></td>
                  <td><%= leak[:year] %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
        <div class="note">
          <i class="fas fa-info-circle"></i> Public leak note
        </div>
      </div>
    <% end %>
  </div>
</section>


<!-- Employee Enumeration -->
<section class="section" id="employee-enum">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-users"></i>
</div>
<h2>Employee Enumeration</h2>
</div>
<div class="section-toggle">
<i class="fas fa-chevron-down"></i>
</div>
</div>
<div class="section-content" style="display: none;">
<p>This section lists publicly accessible employees discovered during reconnaissance. Full role breakdowns and exposure context are available in the Oktoboot dashboard.</p>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-id-badge"></i> Employees</h3>
<p>Total Identified: 2</p>
<div class="employee-grid">
<div class="employee-card">
<div class="employee-avatar">AE</div>
<div class="employee-info">
<div class="employee-name">Alice Example</div>
<div class="employee-role">Engineer</div>
</div>
</div>
<div class="employee-card">
<div class="employee-avatar">BE</div>
<div class="employee-info">
<div class="employee-name">Bob Example</div>
<div class="employee-role">Manager</div>
</div>
</div>
</div>
<div class="note mt-3">
<i class="fas fa-info-circle"></i> Employee note
                        </div>
</div>

</div>
</section>
<!-- Metadata & Public Files -->
<section class="section" id="metadata-files">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-file-alt"></i>
</div>
<h2>Metadata &amp; Public Files</h2>
</div>
<div class="section-toggle">
<i class="fas fa-chevron-down"></i>
</div>
</div>
<div class="section-content" style="display: none;">
<p>This section lists publicly accessible files and detected metadata exposures. View complete data in your Oktoboot dashboard.</p>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-file-download"></i> Discovered Files</h3>
<div class="table-container">
<table>
<thead>
<tr>
<th>File Name</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>document.pdf</td>
<td>https://<%= @report[:domain] %>/document.pdf</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</section>
<!-- Risk Assessment -->
<section class="section" id="risk-assessment">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-exclamation-circle"></i>
</div>
<h2>Risk Assessment</h2>
</div>
<div class="section-toggle">
<i class="fas fa-chevron-down"></i>
</div>
</div>
<div class="section-content" style="display: none;">
<p>The following risks were identified during the reconnaissance phase. They are categorized by severity and may require immediate remediation or strategic consideration.</p>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-radiation"></i> High Risks</h3>
<div class="risk-item high">
<p>‣ Critical vulnerability found</p>
</div>
</div>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-exclamation-triangle"></i> Medium Risks</h3>
<div class="risk-item medium">
<p>‣ Some moderate risk</p>
</div>
</div>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-info-circle"></i> Informational</h3>
<div class="risk-item info">
<p>‣ Informational note</p>
</div>
</div>

</div>
</section>
<!-- Recommendations -->
<section class="section" id="recommendations">
<div class="section-header">
<div class="section-header-left">
<div class="section-header-icon">
<i class="fas fa-clipboard-check"></i>
</div>
<h2>Recommendations</h2>
</div>
<div class="section-toggle">
<i class="fas fa-chevron-down"></i>
</div>
</div>
<div class="section-content" style="display: none;">
<p>Prioritized guidance based on reconnaissance findings. Grouped by severity for operational clarity.</p>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-radiation"></i> Critical Recommendations</h3>
<div class="recommendation-item critical">
<div class="recommendation-area"><i class="fas fa-server"></i> Area: Web Server</div>
<div class="recommendation-text">Upgrade immediately</div>
</div>
</div>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-exclamation-triangle"></i> Important Recommendations</h3>
<div class="recommendation-item important">
<div class="recommendation-area"><i class="fas fa-database"></i> Area: Database</div>
<div class="recommendation-text">Apply patch within 24h</div>
</div>
</div>
<div class="subsection">
<h3 class="subsection-title"><i class="fas fa-info-circle"></i> Best Practice Recommendations</h3>
<div class="recommendation-item best-practice">
<div class="recommendation-area"><i class="fas fa-network-wired"></i> Area: Network</div>
<div class="recommendation-text">Enable firewall logging</div>
</div>
</div>

</div>
</section>
</main>
</div>
<script>
        // Toggle sidebar on mobile
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const sidebar = document.getElementById('sidebar');
            
            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('open');
                });
            }
            
            // Section toggle functionality
            const sectionHeaders = document.querySelectorAll('.section-header');
            
            sectionHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const content = this.nextElementSibling;
                    const toggle = this.querySelector('.section-toggle');
                    const icon = toggle.querySelector('i');
                    
                    if (content.style.display === 'none') {
                        content.style.display = 'block';
                        toggle.classList.add('open');
                        icon.classList.remove('fa-chevron-down');
                        icon.classList.add('fa-chevron-up');
                    } else {
                        content.style.display = 'none';
                        toggle.classList.remove('open');
                        icon.classList.remove('fa-chevron-up');
                        icon.classList.add('fa-chevron-down');
                    }
                });
            });
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('.nav-links a').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all links
                    document.querySelectorAll('.nav-links a').forEach(link => {
                        link.classList.remove('active');
                    });
                    
                    // Add active class to clicked link
                    this.classList.add('active');
                    
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    
                    // Ensure the section is expanded
                    const sectionContent = targetElement.querySelector('.section-content');
                    const toggle = targetElement.querySelector('.section-toggle');
                    const icon = toggle.querySelector('i');
                    
                    if (sectionContent.style.display === 'none') {
                        sectionContent.style.display = 'block';
                        toggle.classList.add('open');
                        icon.classList.remove('fa-chevron-down');
                        icon.classList.add('fa-chevron-up');
                    }
                    
                    // Close sidebar on mobile after clicking a link
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('open');
                    }
                });
            });
        });
    </script>


    <script>
  const ctx = document.getElementById('myChart');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Malware', 'Phishing', 'Ransomware', 'Insider Threats'],
      datasets: [{
        label: 'Threat Types',
        data: [45, 30, 15, 10],
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)'
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
</script>
 
